<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Daniel's Website</title>
    <link rel="stylesheet" href="assets/style.css">
    <!-- Load PrismJS for syntax highlighting.  The cpp component provides
         C++ grammar definitions used by Prism.highlight().  These scripts
         are loaded locally from the assets folder to avoid external
         dependencies. -->
    <script src="assets/prism.js"></script>
    <script src="assets/prism-cpp.js"></script>
  </head>
  <body>
    <header>
      <div class="hero-left">
        <h1>Hello, I'm Daniel Liang.</h1>
        <p>I like comp(prog + math), research, gymming, hooping, gaming and some more! Interested in AI and its applications in healthcare and robotics. I blog sometimes.</p>
        <div class="chips">
          <button id="theme-toggle" aria-label="Toggle dark/light mode">
            <!-- Sun Icon -->
            <svg id="icon-sun" viewBox="0 0 24 24" stroke-width="2" fill="none">
              <circle cx="12" cy="12" r="5" />
              <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M17.36 17.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M17.36 6.64l1.42-1.42" />
            </svg>
            <!-- Moon Icon -->
            <svg id="icon-moon" viewBox="0 0 24 24" stroke-width="2">
              <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
            </svg>
          </button>
          <a href="#blog">Blog</a>
          <a href="#usaco">USACO</a>
          <a href="#videos">Videos</a>
          <a href="#misc">Miscellaneous</a>
        </div>
      </div><!-- close hero-left -->
      <!-- Place the D viewer on the right side of the hero.  It sits next to the intro/chips rather than below them. -->
      <div class="hero-right">
        <pre id="torus-viewer" aria-label="ASCII D"></pre>
        <div class="inspired">
          Inspired by <a href="https://www.a1k0n.net/2011/07/20/donut-math.html" target="_blank" rel="noopener">a1k0n</a>
        </div>
      </div>
    </header>
    <main>
      <!-- Blog Section -->
      <section id="blog">
        <h2>Blog</h2>
        <div class="cards" id="blog-cards">
          <!-- Blog cards will be injected by script -->
        </div>
      </section>
      <!-- USACO Section -->
      <section id="usaco">
        <h2>Algorithms (C++)</h2>
        <p>Tip: Click 'View' to open code side‑by‑side. 'Close' returns to the full‑width list.</p>
        <div id="usaco-container">
          <!-- Algorithm list column -->
          <div id="usaco-list">
            <!-- Items inserted via script -->
          </div>
          <!-- Viewer column (hidden by default) -->
          <div id="usaco-viewer">
            <div id="viewer-header">
              <span id="viewer-filename"></span>
              <div class="viewer-controls">
                <input id="viewer-search" type="text" placeholder="Search" />
                <button id="search-prev">Prev</button>
                <button id="search-next">Next</button>
                <span id="search-count"></span>
                <button id="copy-code">Copy</button>
                <button id="close-viewer">Close</button>
              </div>
            </div>
            <div id="viewer-content">
              <!-- Highlighted code inserted here -->
            </div>
          </div>
        </div>
      </section>
      <!-- Videos Section -->
      <section id="videos">
        <h2>Videos</h2>
        <div class="cards" id="video-cards">
          <!-- Video cards will be injected by script -->
        </div>
      </section>
      <!-- Misc Section -->
      <section id="misc">
        <h2>Miscellaneous</h2>
        <div class="cards" id="misc-cards">
          <!-- Misc cards will be injected by script -->
        </div>
      </section>
    </main>
    <footer>
      <p>© <span id="current-year"></span> Daniel Liang</p>
      <div class="social-icons">
        <a href="https://github.com/danieldliang" target="_blank" aria-label="GitHub">
          <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
            <path d="M12 .296c-6.626 0-12 5.373-12 12 0 5.304 3.438 9.8 8.205 11.387.6.111.82-.261.82-.577 0-.285-.011-1.04-.016-2.04-3.338.724-4.042-1.61-4.042-1.61-.546-1.387-1.333-1.758-1.333-1.758-1.087-.743.084-.728.084-.728 1.205.084 1.839 1.236 1.839 1.236 1.07 1.834 2.809 1.304 3.495.997.108-.775.418-1.305.762-1.605-2.665-.304-5.466-1.332-5.466-5.932 0-1.31.469-2.381 1.236-3.221-.124-.303-.536-1.523.117-3.176 0 0 1.008-.322 3.301 1.23.959-.267 1.987-.399 3.008-.404 1.02.005 2.049.137 3.009.404 2.291-1.552 3.297-1.23 3.297-1.23.655 1.653.244 2.873.12 3.176.77.84 1.235 1.911 1.235 3.221 0 4.61-2.803 5.625-5.475 5.922.43.371.823 1.103.823 2.222 0 1.606-.015 2.903-.015 3.296 0 .319.218.694.825.576C20.565 22.092 24 17.598 24 12.296c0-6.627-5.373-12-12-12" />
          </svg>
        </a>
        <a href="https://www.linkedin.com/in/daniel-liang-69298a257/" target="_blank" aria-label="LinkedIn">
          <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
            <path d="M22.225 0H1.771C.792 0 0 .771 0 1.708v20.536C0 23.23.792 24 1.771 24h20.451C23.207 24 24 23.23 24 22.244V1.708C24 .771 23.207 0 22.225 0zM7.645 20.452H3.979V9.001h3.666v11.451zm-1.833-13.07a2.071 2.071 0 110-4.142 2.071 2.071 0 010 4.142zm14.635 13.07h-3.554v-5.569c0-1.328-.027-3.036-1.852-3.036-1.853 0-2.136 1.445-2.136 2.939v5.666h-3.553V9.001h3.414v1.561h.049c.476-.901 1.637-1.852 3.372-1.852 3.602 0 4.267 2.368 4.267 5.448v6.294z" />
          </svg>
        </a>
      </div>
    </footer>
    <script>
      // Helper to read text file relative to the site. If fetch is not permitted (e.g. local file protocol),
      // falls back to embedding raw content compiled below. This ensures the viewer works locally.
      const FILE_CACHE = {};
      // Preload algorithm file contents as raw strings. They will be filled by inline script later.

      // Embedded lists of blog posts, videos and miscellaneous items extracted from the
      // original site. Embedding these here avoids relying on fetch() to load
      // file:// URLs, which can fail in some browsers. Each entry contains a
      // title, a short snippet and a URL to the full page or resource.
      const BLOG_POSTS = [
        {
          title: 'Fourth Post: 9/2/2024',
          snippet: "Alrighty guys, school starts tomorrow. Here's a recap of how my summer went: 1. Attended Garcia. Was a really fun program...",
          url: 'blog/fourth-post.html'
        },
        {
          title: 'Third Post: 4/19/2024',
          snippet: "Hello everyone. I remembered I had a blog. Anyways, spring break has begun! Here's a recap of how my junior yr's been going...",
          url: 'blog/third-post.html'
        },
        {
          title: 'Second Post: 2/9/2024',
          snippet: 'cool stuff',
          url: 'blog/second-post.html'
        },
        {
          title: 'First Post: 2/9/2024',
          snippet: 'First Post! YAY! Hopefully I keep this active. Happy Chinese New Year!',
          url: 'blog/first-post.html'
        }
      ];
      const VIDEO_ITEMS = [
        {
          title: 'Inconspicuous Video',
          snippet: 'A short video; nothing to be suspicious of',
          url: 'https://www.youtube.com/watch?v=dQw4w9WgXcQ',
          linkTitles: ['Watch']
        }
      ];
      const MISC_ITEMS = [];
    </script>
    <script>
      // Insert current year in footer
      document.getElementById('current-year').textContent = new Date().getFullYear();

       // Theme persistence
       const bodyEl = document.body;
       const themeToggle = document.getElementById('theme-toggle');
       // Apply stored theme on load. If no preference stored, follow system preference.
       const storedTheme = localStorage.getItem('theme');
       if (storedTheme === 'dark' || (!storedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
         bodyEl.classList.add('dark');
       }
       // Toggle dark mode on click and persist selection
       themeToggle.addEventListener('click', () => {
         bodyEl.classList.toggle('dark');
         const newTheme = bodyEl.classList.contains('dark') ? 'dark' : 'light';
         localStorage.setItem('theme', newTheme);
       });

      // Simple C++ syntax highlighter. This function escapes HTML and then wraps keywords, strings, comments, numbers and types with spans.
      function highlightCpp(raw) {
        // Escape HTML special characters first
        let escaped = raw
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;');
        // Highlight strings (double or single quotes)
        escaped = escaped.replace(/("([^"\\]|\\.)*"|'([^'\\]|\\.)*')/g, '<span class="text-emerald-500">$1</span>');
        // Highlight comments (//... and /* ... */)
        escaped = escaped.replace(/(\/\/.*?$|\/\*[\s\S]*?\*\/)/gm, '<span class="text-gray-500">$1</span>');
        // Highlight keywords
        const keywordRegex = /\b(alignas|alignof|and|and_eq|asm|auto|bitand|bitor|bool|break|case|catch|char|char16_t|char32_t|class|compl|const|constexpr|const_cast|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|false|float|for|friend|goto|if|inline|int|long|mutable|namespace|new|noexcept|not|not_eq|nullptr|operator|or|or_eq|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|true|try|typedef|typeid|typename|union|unsigned|using|virtual|void|volatile|wchar_t|while|xor|xor_eq)\b/g;
        escaped = escaped.replace(keywordRegex, '<span class="text-purple-500">$1</span>');
        // Highlight built-in types (common STL containers etc.)
        const typeRegex = /\b(vector|string|map|set|unordered_map|unordered_set|pair|queue|stack|priority_queue|list|deque|array|tuple)\b/g;
        escaped = escaped.replace(typeRegex, '<span class="text-blue-400">$1</span>');
        // Highlight numbers
        escaped = escaped.replace(/\b(\d+)(\.?\d*)\b/g, '<span class="text-orange-500">$1$2</span>');
        return escaped;
      }

      // Build blog cards from embedded list
      function loadBlog() {
        const container = document.getElementById('blog-cards');
        BLOG_POSTS.forEach(post => {
          const a = document.createElement('a');
          a.href = post.url;
          a.target = '_blank';
          a.className = 'card';
          const h3 = document.createElement('h3');
          h3.textContent = post.title;
          const p = document.createElement('p');
          p.textContent = post.snippet;
          a.appendChild(h3);
          a.appendChild(p);
          container.appendChild(a);
        });
      }

      // Build video cards from embedded list
      function loadVideos() {
        const container = document.getElementById('video-cards');
        VIDEO_ITEMS.forEach(item => {
          // Create a card container instead of making the entire card a link. This
          // allows us to add small link buttons inside while keeping the card
          // itself purely informational.
          const card = document.createElement('div');
          card.className = 'card';
          // Title
          const h3 = document.createElement('h3');
          h3.textContent = item.title;
          card.appendChild(h3);
          // Optional snippet/description
          if (item.snippet) {
            const p = document.createElement('p');
            p.textContent = item.snippet;
            card.appendChild(p);
          }
          // Links container with minimalistic buttons
          const linksDiv = document.createElement('div');
          linksDiv.className = 'video-links';
          // Support multiple links per item by allowing item.url to be a string or an array
          const urls = Array.isArray(item.url) ? item.url : [item.url];
          urls.forEach((link, index) => {
            const linkEl = document.createElement('a');
            linkEl.href = link;
            linkEl.target = '_blank';
            linkEl.textContent = item.linkTitles && item.linkTitles[index] ? item.linkTitles[index] : 'Link';
            linksDiv.appendChild(linkEl);
          });
          card.appendChild(linksDiv);
          container.appendChild(card);
        });
      }

      // Build miscellaneous cards from embedded list
      function loadMisc() {
        const container = document.getElementById('misc-cards');
        MISC_ITEMS.forEach(item => {
          const a = document.createElement('a');
          a.href = item.url;
          a.target = '_blank';
          a.className = 'card';
          const h3 = document.createElement('h3');
          h3.textContent = item.title;
          const p = document.createElement('p');
          p.textContent = item.snippet;
          a.appendChild(h3);
          a.appendChild(p);
          container.appendChild(a);
        });
      }

      // Build algorithm list and set up viewer
      function buildUsacoList(files) {
        const listEl = document.getElementById('usaco-list');
        files.forEach(file => {
          const row = document.createElement('div');
          row.className = 'row';
          const nameSpan = document.createElement('span');
          nameSpan.className = '';
          nameSpan.textContent = file;
          const btnContainer = document.createElement('div');
          btnContainer.className = 'buttons';
          const viewBtn = document.createElement('button');
          viewBtn.textContent = 'View';
          viewBtn.className = '';
          viewBtn.addEventListener('click', () => openViewer(file));
          const dlLink = document.createElement('a');
          dlLink.textContent = 'Download';
          // Use a data URI for downloads.  When users click the link, the
          // raw source code is encoded as a text/plain blob and offered
          // for download.  This avoids broken links when the original
          // directory is not present on the server.
          const raw = FILE_CACHE[file] || '';
          dlLink.href = 'data:text/plain;charset=utf-8,' + encodeURIComponent(raw);
          dlLink.setAttribute('download', file);
          dlLink.className = '';
          btnContainer.appendChild(viewBtn);
          btnContainer.appendChild(dlLink);
          row.appendChild(nameSpan);
          row.appendChild(btnContainer);
          listEl.appendChild(row);
        });
      }

      // Viewer state
      let currentHits = [];
      let currentHitIndex = 0;
      // Raw code currently loaded in viewer. Used to re-highlight after search.
      let currentRaw = '';
      function renderHits() {
        const countEl = document.getElementById('search-count');
        if (currentHits.length) {
          countEl.textContent = `${currentHitIndex + 1}/${currentHits.length}`;
        } else {
          countEl.textContent = '0/0';
        }
      }
       async function fetchFile(file) {
         // Try to fetch the C++ source file from the original folder.  When
         // the site is served over HTTP this will succeed.  If the fetch
         // fails (for example when viewing locally via file://), fall back
         // to a cached base64‑embedded version.  The cache contains raw
         // source code without any HTML markup.
         try {
           const res = await fetch('original/stuff/usaco/algos/' + file);
           if (res.ok) {
             return await res.text();
           }
         } catch (_) {}
         return FILE_CACHE[file] || '';
       }
      async function openViewer(file) {
        // Show viewer and update layout classes so the list and viewer share the space on wider screens
        const viewer = document.getElementById('usaco-viewer');
        const container = document.getElementById('usaco-container');
        viewer.style.display = 'flex';
        container.classList.add('viewer-open');
        // On small screens, scroll to viewer
        viewer.scrollIntoView({ behavior: 'smooth' });
        // Set filename header
        document.getElementById('viewer-filename').textContent = file;
        // Load file text
        currentRaw = await fetchFile(file);
        // Clear search state
        currentHits = [];
        currentHitIndex = 0;
        document.getElementById('viewer-search').value = '';
        renderHits();
        // Render highlighted content
        renderViewer();
      }

      // Basic syntax highlighter for C++ used in the viewer.  This
      // function escapes HTML and highlights strings, comments,
      // keywords, common STL types and numeric literals.  It returns
      // an HTML string containing <span> tags with Prism‑like
      // classes (token string, token comment, token keyword,
      // token class-name and token number).  Because highlighting
      // occurs on the raw source prior to inserting any markup into
      // the DOM, it avoids re-highlighting the markup itself.
      function simpleHighlightCpp(raw) {
        let escaped = raw
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;');
        // Strings (double or single quoted)
        escaped = escaped.replace(/("([^"\\]|\\.)*"|'([^'\\]|\\.)*')/g, '<span class="token string">$1</span>');
        // Comments (// and /* */)
        escaped = escaped.replace(/(\/\/.*?$|\/\*[\s\S]*?\*\/)/gm, '<span class="token comment">$1</span>');
        // Keywords
        const keywordRegex = /\b(alignas|alignof|and|and_eq|asm|auto|bitand|bitor|bool|break|case|catch|char|char16_t|char32_t|class|compl|const|constexpr|const_cast|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|false|float|for|friend|goto|if|inline|int|long|mutable|namespace|new|noexcept|not|not_eq|nullptr|operator|or|or_eq|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|true|try|typedef|typeid|typename|union|unsigned|using|virtual|void|volatile|wchar_t|while|xor|xor_eq)\b/g;
        escaped = escaped.replace(keywordRegex, '<span class="token keyword">$1</span>');
        // Common STL container and type names -> class-name
        const typeRegex = /\b(vector|string|map|set|unordered_map|unordered_set|pair|queue|stack|priority_queue|list|deque|array|tuple)\b/g;
        escaped = escaped.replace(typeRegex, '<span class="token class-name">$1</span>');
        // Numeric literals (integers and floats)
        escaped = escaped.replace(/\b(\d+)(\.\d+)?\b/g, '<span class="token number">$1$2</span>');
        return escaped;
      }

      // Render the viewer content using PrismJS.  It applies syntax
      // highlighting to the raw source via Prism.highlight(), splits
      // the highlighted string into lines, and wraps each with a
      // line-number span.  Because Prism inserts its own markup, we
      // do not escape HTML here; Prism escapes special characters as
      // necessary.  Called on initial load and whenever the search
      // state resets.
      function renderViewer() {
        const contentEl = document.getElementById('viewer-content');
        // Highlight the currently loaded C++ source using our simple
        // syntax highlighter.  Do not attempt to strip HTML tags
        // from currentRaw: the FILE_CACHE entries contain the raw
        // C++ source without markup, so removing angle bracket
        // sequences would inadvertently strip template arguments and
        // other syntactic elements.  simpleHighlightCpp() escapes
        // HTML special characters and wraps recognised tokens in
        // <span class="token ..."> tags.
        // Escape the raw C++ source for safe HTML display.  Avoid
        // inserting any additional markup so that the code is shown
        // exactly as written.  Escaping ensures that angle brackets
        // and ampersands are displayed correctly in the browser.
        const highlighted = currentRaw
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;');
        // Split on newlines to build code rows.  Each row contains a line
        // number and the highlighted code for that line.
        const lines = highlighted.split(/\n/);
        const htmlLines = lines.map((line, idx) => {
          return '<div class="code-row">' +
                   '<span class="select-none">' + (idx + 1) + '</span>' +
                   '<span class="code">' + line + '</span>' +
                 '</div>';
        });
        contentEl.innerHTML = htmlLines.join('');
      }
      // Close viewer
      document.getElementById('close-viewer').addEventListener('click', () => {
        const viewer = document.getElementById('usaco-viewer');
        const container = document.getElementById('usaco-container');
        viewer.style.display = 'none';
        container.classList.remove('viewer-open');
      });
      // Search functionality
      document.getElementById('viewer-search').addEventListener('input', () => {
        const query = document.getElementById('viewer-search').value.trim();
        // Reset the viewer to its highlighted state before applying search marks
        renderViewer();
        currentHits = [];
        currentHitIndex = 0;
        if (query) {
          const contentEl = document.getElementById('viewer-content');
          const regex = new RegExp(query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
          // iterate text nodes inside viewer and highlight matches
          const walker = document.createTreeWalker(contentEl, NodeFilter.SHOW_TEXT, null);
          while (walker.nextNode()) {
            const node = walker.currentNode;
            const parent = node.parentElement;
            const matches = [...node.textContent.matchAll(regex)];
            if (matches.length) {
              let lastIndex = 0;
              const fragments = [];
              matches.forEach(m => {
                const start = m.index;
                const end = start + m[0].length;
                fragments.push(document.createTextNode(node.textContent.slice(lastIndex, start)));
                const mark = document.createElement('mark');
                mark.className = '';
                mark.textContent = node.textContent.slice(start, end);
                fragments.push(mark);
                currentHits.push(mark);
                lastIndex = end;
              });
              fragments.push(document.createTextNode(node.textContent.slice(lastIndex)));
              fragments.forEach(f => parent.insertBefore(f, node));
              parent.removeChild(node);
            }
          }
          if (currentHits.length) {
            currentHitIndex = 0;
            scrollToHit(currentHits[currentHitIndex]);
          }
        }
        renderHits();
      });
      function scrollToHit(el) {
        const viewerContent = document.getElementById('viewer-content');
        const rect = el.getBoundingClientRect();
        const containerRect = viewerContent.getBoundingClientRect();
        viewerContent.scrollTop += rect.top - containerRect.top - containerRect.height / 2 + el.offsetHeight;
      }
      document.getElementById('search-next').addEventListener('click', () => {
        if (!currentHits.length) return;
        currentHitIndex = (currentHitIndex + 1) % currentHits.length;
        scrollToHit(currentHits[currentHitIndex]);
        renderHits();
      });
      document.getElementById('search-prev').addEventListener('click', () => {
        if (!currentHits.length) return;
        currentHitIndex = (currentHitIndex - 1 + currentHits.length) % currentHits.length;
        scrollToHit(currentHits[currentHitIndex]);
        renderHits();
      });
      // Copy code button
      document.getElementById('copy-code').addEventListener('click', async () => {
        const filename = document.getElementById('viewer-filename').textContent;
        const raw = await fetchFile(filename);
        try {
          await navigator.clipboard.writeText(raw);
          alert('Code copied to clipboard');
        } catch (err) {
          console.error(err);
        }
      });

      // ==== ASCII 'D' viewer (draggable) ====
      function initDViewer() {
        const out = document.getElementById('torus-viewer');
        if (!out) return;
      
        let dragging = false;
        let lastX = 0, lastY = 0;
        let A = 0, B = 0; // rotation angles
        let auto = true;
      
        // Increase grid resolution so the 3D 'D' is more visible.  A wider and
        // taller grid yields a larger rendered shape.  These values were
        // tuned to produce a clearly legible letter on the page.  The
        // height/width ratio roughly matches a capital D when rendered
        // upright.
        // Reduce the grid height and slightly narrow the width.  A shorter
        // height makes the ASCII letter more compact vertically and
        // eliminates unused whitespace underneath.  Keeping a generous
        // width preserves legibility.
        const W = 75;
        const H = 28;     // ascii grid size
        const zbufSize = W * H;
      
        // Build point cloud for a 3D 'D' (extruded outline):
        // - vertical bar thickness = t
        // - outer semicircle radius = r
        // - inner radius rInner = r - t (hole)
        // - extruded depth along z in [-extrude, extrude]
        // The following parameters were enlarged to improve visibility of
        // the letter; adjust to taste.
        const r = 16;           // radius of curved part
        const t = 6;            // thickness of vertical bar
        const height = 32;      // total height (|y| <= height/2)
        const extrude = 6;      // half-depth
        const stepCurve = 0.05; // finer angular sampling
        const stepZ = 0.6;      // finer depth sampling
      
        const points = [];  // each: {pos:[x,y,z], norm:[nx,ny,nz]}
      
        function addPoint(x,y,z,nx,ny,nz){
          const nlen = Math.hypot(nx,ny,nz) || 1;
          points.push({pos:[x,y,z], norm:[nx/nlen, ny/nlen, nz/nlen]});
        }
      
        // Curved outer face (semi-cylinder)
        for (let theta=-Math.PI/2; theta<=Math.PI/2; theta+=stepCurve){
          const cx = t + r * Math.cos(theta);
          const cy = (height/2) * Math.sin(theta); // slight vertical squash looks nicer
          const nx = Math.cos(theta);
          const ny = Math.sin(theta);
          for (let z=-extrude; z<=extrude; z+=stepZ){
            addPoint(cx, cy, z, nx, ny, 0);
          }
        }
        // Inner hole face (semi-cylinder)
        const rInner = r - t;
        if (rInner > 0){
          for (let theta=-Math.PI/2; theta<=Math.PI/2; theta+=stepCurve){
            const cx = t + rInner * Math.cos(theta);
            const cy = (height/2 - t) * Math.sin(theta);
            const nx = -Math.cos(theta);
            const ny = -Math.sin(theta);
            for (let z=-extrude; z<=extrude; z+=stepZ){
              addPoint(cx, cy, z, nx, ny, 0);
            }
          }
        }
        // Curved vertical bar surfaces.  To reduce the appearance of
        // perfectly flat faces on the "D" we approximate the bar as
        // a series of narrow slices forming a quarter cylinder.  For
        // each slice at position i in [0,t], compute a normal that
        // sweeps from pointing fully left (i=0) to fully right (i=t).
        // The z component of the normal is chosen so that nx^2 + nz^2 = 1.
        for (let i = 0; i <= t; i += 1) {
          // Normal components: nx varies from -1 to 1 across the bar
          const nx = (i - t/2) / (t/2);
          const nz = Math.sqrt(Math.max(0, 1 - nx*nx));
          for (let y = -height/2; y <= height/2; y += 1) {
            for (let z = -extrude; z <= extrude; z += stepZ) {
              addPoint(i, y, z, nx, 0, nz);
            }
          }
        }
        // Front/back caps on the bar remain flat.  These faces close
        // off the bar at either end of the extrusion.
        for (let x=0; x<=t; x+=1){
          for (let y=-height/2; y<=height/2; y+=1){
            addPoint(x, y, -extrude, 0,0,-1);
            addPoint(x, y,  extrude, 0,0, 1);
          }
        }
        // Caps along curved sections for solidity
        for (let theta=-Math.PI/2; theta<=Math.PI/2; theta+=stepCurve){
          const xo = t + r*Math.cos(theta);
          const yo = (height/2)*Math.sin(theta);
          const xi = t + Math.max(0,rInner)*Math.cos(theta);
          const yi = (height/2 - t)*Math.sin(theta);
          addPoint(xo, yo, -extrude, 0,0,-1);
          addPoint(xo, yo,  extrude, 0,0, 1);
          if (rInner>0){
            addPoint(xi, yi, -extrude, 0,0,-1);
            addPoint(xi, yi,  extrude, 0,0, 1);
          }
        }
      
        function mulRot([x,y,z], A, B){
          // rotate around Y (A), then X (B)
          const ca=Math.cos(A), sa=Math.sin(A);
          const cb=Math.cos(B), sb=Math.sin(B);
          // Y-rotation
          let X =  ca*x + sa*z;
          let Z = -sa*x + ca*z;
          let Y = y;
          // X-rotation
          let Y2 = cb*Y - sb*Z;
          let Z2 = sb*Y + cb*Z;
          return [X,Y2,Z2];
        }
      
        function project([x,y,z]){
          const K1 = 20, dist = 40;
          const ooz = 1/(z+dist);
          const xp = Math.floor(W/2 + K1*ooz*x);
          const yp = Math.floor(H/2 - K1*ooz*y*0.6);
          return {xp, yp, ooz};
        }
      
        function shade(n){
          // simple Lambert shading with light pointing toward viewer (0,0,1)
          // Scale the normal's z component into the range [0,1] and apply
          // a mild exponent to favour darker glyphs on surfaces that do
          // not face the viewer directly.  A larger exponent yields
          // lower brightness values for shallow angles, creating a
          // darker overall appearance.  Adjust the offset and divisor
          // to tune ambient light.
          // Offset and scale the normal's z component into [0,1] to
          // compute a base diffuse term.  We add a slightly larger
          // offset and divisor to ensure surfaces facing away from
          // the camera still receive some light.  Then raise the
          // result to a small exponent (<1) so that a wide range of
          // normal values map to high brightness.  A smaller
          // exponent darkens the overall letter by pushing more
          // values toward 1.0.  Finally, map the brightness to a
          // reversed character ramp so that larger brightness
          // selects darker glyphs.  This produces a much darker
          // rendering of the D and reduces the appearance of light
          // flat surfaces.
          let dot = (n[2] + 0.3) / 1.3;
          if (dot < 0) dot = 0;
          if (dot > 1) dot = 1;
          // Use an even smaller exponent to push most brightness
          // values toward 1.0, making the ASCII letter darker overall.
          const brightness = Math.pow(dot, 0.05);
          const ramp = " .:-=+*#%@";
          return ramp[Math.floor(brightness * (ramp.length - 1))];
        }
      
        function frame(){
          if (auto && !dragging) { A += 0.01; B += 0.005; }
          const buf = new Array(W*H).fill(' ');
          const zbuf = new Float32Array(zbufSize);
          zbuf.fill(0);
      
          for (const p of points){
            const pos = mulRot(p.pos, A, B);
            const nrm = mulRot(p.norm, A, B);
            const pr = project(pos);
            const idx = pr.xp + pr.yp*W;
            if (pr.xp>=0 && pr.xp<W && pr.yp>=0 && pr.yp<H){
              if (pr.ooz > zbuf[idx]){
                zbuf[idx] = pr.ooz;
                buf[idx] = shade(nrm);
              }
            }
          }
      
          // write lines
          let outStr='';
          for (let y=0;y<H;y++){
            outStr += buf.slice(y*W, y*W+W).join('') + "\n";
          }
          out.textContent = outStr;
          requestAnimationFrame(frame);
        }
      
        // Drag-to-rotate.  When dragging ends, re-enable auto rotation so
        // the letter continues to spin.
        out.addEventListener('mousedown', e=>{ dragging=true; auto=false; lastX=e.clientX; lastY=e.clientY; });
        window.addEventListener('mouseup', ()=> { dragging=false; auto=true; });
        window.addEventListener('mousemove', e=>{
          if (!dragging) return;
          const dx = (e.clientX-lastX)/120;
          const dy = (e.clientY-lastY)/120;
          A += dx; B += dy;
          lastX = e.clientX; lastY = e.clientY;
        });
        
        frame();
      }

      // Initialize site
      async function initSite() {
        // Preload algorithm files into cache (for offline fallback). The following lines are
        // auto-generated to embed file names and base64-encoded contents. Each entry populates
        // FILE_CACHE so that the viewer can still display code when fetch() is disallowed.
        const algoFiles = ["bellmanford.cpp", "benqsmodintshort.cpp", "djikstras.cpp", "dsu.cpp", "eulertour.cpp", "floydwarshall.cpp", "modinved.cpp", "rollingandfasthash.cpp", "segtree.cpp", "toposort.cpp"];
        FILE_CACHE['bellmanford.cpp'] = atob('Ly8gVGFrZW4gYW5kIGVkaXRlZCBvZmYgb2YgR0ZHcwp2b2lkIEJlbGxtYW5Gb3JkKGludCBncmFwaFtdWzNdLCBpbnQgViwgaW50IEUsCiAgICAgICAgICAgICAgICAgaW50IHNyYykKewogICAgaW50IGRpc1tWXTsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgVjsgaSsrKQogICAgICAgIGRpc1tpXSA9IElOVF9NQVg7CiAKICAgIGRpc1tzcmNdID0gMDsKIAogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBWIC0gMTsgaSsrKSB7CiAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBFOyBqKyspIHsKICAgICAgICAgICAgaWYgKGRpc1tncmFwaFtqXVswXV0gIT0gSU5UX01BWCAmJiBkaXNbZ3JhcGhbal1bMF1dICsgZ3JhcGhbal1bMl0gPAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzW2dyYXBoW2pdWzFdXSkKICAgICAgICAgICAgICAgIGRpc1tncmFwaFtqXVsxXV0gPSAKICAgICAgICAgICAgICAgICAgZGlzW2dyYXBoW2pdWzBdXSArIGdyYXBoW2pdWzJdOwogICAgICAgIH0KICAgIH0KIAogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBFOyBpKyspIHsKICAgICAgICBpbnQgeCA9IGdyYXBoW2ldWzBdOwogICAgICAgIGludCB5ID0gZ3JhcGhbaV1bMV07CiAgICAgICAgaW50IHdlaWdodCA9IGdyYXBoW2ldWzJdOwogICAgICAgIGlmIChkaXNbeF0gIT0gSU5UX01BWCAmJgogICAgICAgICAgICAgICAgICAgZGlzW3hdICsgd2VpZ2h0IDwgZGlzW3ldKQogICAgICAgICAgICBjb3V0IDw8ICJHcmFwaCBjb250YWlucyBuZWdhdGl2ZSB3ZWlnaHQgY3ljbGUiIDw8IGVuZGw7CiAgICB9CiAKICAgIGNvdXQgPDwgIlZlcnRleCBEaXN0YW5jZSBmcm9tIFNvdXJjZSIgPDwgZW5kbDsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgVjsgaSsrKQogICAgICAgIGNvdXQgPDwgYSA8PCAiXHRcdCIgPDwgZGlzW2ldIDw8IGVuZGw7Cn0K');
        FILE_CACHE['benqsmodintshort.cpp'] = atob('Ly8gU291cmNlOiBCZW4gUWkKCi8qKgogKiBEZXNjcmlwdGlvbjogTW9kdWxhciBhcml0aG1ldGljLiBBc3N1bWVzICRNT0QkIGlzIHByaW1lLgogKiBTb3VyY2U6IEtBQ1RMCiAqIFZlcmlmaWNhdGlvbjogaHR0cHM6Ly9vcGVuLmthdHRpcy5jb20vcHJvYmxlbXMvbW9kdWxhcmFyaXRobWV0aWMKICogVXNhZ2U6IG1pIGEgPSBNT0QrNTsgaW52KGEpOyAvLyA0MDAwMDAwMDMKICovCgp0ZW1wbGF0ZTxpbnQgTU9ELCBpbnQgUlQ+IHN0cnVjdCBtaW50IHsKCXN0YXRpYyBjb25zdCBpbnQgbW9kID0gTU9EOwoJc3RhdGljIGNvbnN0ZXhwciBtaW50IHJ0KCkgeyByZXR1cm4gUlQ7IH0gLy8gcHJpbWl0aXZlIHJvb3QKIAlpbnQgdjsgCiAJZXhwbGljaXQgb3BlcmF0b3IgaW50KCkgY29uc3QgeyByZXR1cm4gdjsgfSAKCW1pbnQoKTp2KDApIHt9CgltaW50KGxsIF92KTp2KGludChfdiVNT0QpKSB7IHYgKz0gKHY8MCkqTU9EOyB9CgltaW50JiBvcGVyYXRvcis9KG1pbnQgbykgeyAKCQlpZiAoKHYgKz0gby52KSA+PSBNT0QpIHYgLT0gTU9EOyAKCQlyZXR1cm4gKnRoaXM7IH0KCW1pbnQmIG9wZXJhdG9yLT0obWludCBvKSB7IAoJCWlmICgodiAtPSBvLnYpIDwgMCkgdiArPSBNT0Q7IAoJCXJldHVybiAqdGhpczsgfQoJbWludCYgb3BlcmF0b3IqPShtaW50IG8pIHsgCgkJdiA9IGludCgobGwpdipvLnYlTU9EKTsgcmV0dXJuICp0aGlzOyB9CglmcmllbmQgbWludCBwb3cobWludCBhLCBsbCBwKSB7IGFzc2VydChwID49IDApOwoJCXJldHVybiBwPT0wPzE6cG93KGEqYSxwLzIpKihwJjE/YToxKTsgfQoJZnJpZW5kIG1pbnQgaW52KG1pbnQgYSkgeyBhc3NlcnQoYS52ICE9IDApOyByZXR1cm4gcG93KGEsTU9ELTIpOyB9CglmcmllbmQgbWludCBvcGVyYXRvcisobWludCBhLCBtaW50IGIpIHsgcmV0dXJuIGEgKz0gYjsgfQoJZnJpZW5kIG1pbnQgb3BlcmF0b3ItKG1pbnQgYSwgbWludCBiKSB7IHJldHVybiBhIC09IGI7IH0KCWZyaWVuZCBtaW50IG9wZXJhdG9yKihtaW50IGEsIG1pbnQgYikgeyByZXR1cm4gYSAqPSBiOyB9Cn07CnVzaW5nIG1pID0gbWludDwoaW50KTFlOSs3LCA1PjsKdXNpbmcgdm1pID0gdmVjdG9yPG1pPjsK');
        FILE_CACHE['djikstras.cpp'] = atob('Ly8gdG9vayBhbmQgZWRpdGVkIGZyb20gR0ZHcwppbnQgbWFpbigpIHsKCXByaW9yaXR5X3F1ZXVlPHBhaXI8aW50LCBpbnQ+LCB2ZWN0b3I8cGFpcjxpbnQsIGludD4+LCBncmVhdGVyPHBhaXI8aW50LCBpbnQ+PiA+IHBxOyAvLyBiZnMgdXNlcyBxdWV1ZSwgZGZzIHVzZXMgc3RhY2ssIGRqaWtzdHJhJ3MgdXNlcyBwcQoKCXZlY3RvcjxpbnQ+IGRpc3QoViwgSU5UX01BWCk7IC8vIGRpc3RhbmNlIHZlY3RvciAobWFwcyBub2RlIElELCBnaXZlbiBieSB2ZWN0b3IgaW5kZXgsIHRvIHNob3J0ZXN0IGRpc3RhbmNlIGJldHdlZW4gdGhlIHNvdXJjZSBub2RlIHRvIHRoZSBub2RlKQoKCXBxLnB1c2gobWFrZV9wYWlyKDAsIHNyYykpOwoJZGlzdFtzcmNdID0gMDsKCgl3aGlsZSAoIXBxLmVtcHR5KCkpIHsgLy8gbm90aWNlIHRoZSBwYXR0ZXJuIGJldHdlZW4gZGppa3N0cmEncyBhbmQgYmZzLCBkZnMKCQlpbnQgdXcgPSBwcS50b3AoKS5maXJzdCwgdSA9IHBxLnRvcCgpLnNlY29uZDsKCQlwcS5wb3AoKTsKCgkJaWYgKHV3ICE9IGRpc3RbdV0pIGNvbnRpbnVlOwoJCQoJCWZvciAoY29uc3QgYXV0byYgbmV4dDogYWRqW3VdKSB7IC8vIGFkaiBpcyBhIHZlY3RvciB3aGljaCBtYXBzIG5vZGUgSUQgKGFzIGluZGV4KSB0byBwYWlyPGludCAodGhpcyBpcyB0aGUgbmV4dCBhZGphY2VudCBub2RlIElEKSwgaW50ICh3ZWlnaHQgb2YgZWRnZSB3aGljaCBjb25uZWN0cyBjdXJyZW50IG5vZGUgdG8gc2FpZCBhZGphY2VudCBub2RlKT4KCQkJaW50IHYgPSBuZXh0LmZpcnN0OwoJCQlpbnQgd2VpZ2h0ID0gbmV4dC5zZWNvbmQ7CgoJCQlpZiAoZGlzdFt2XSA+IGRpc3RbdV0gKyB3ZWlnaHQpIHsKCQkJCWRpc3Rbdl0gPSBkaXN0W3VdICsgd2VpZ2h0OyAvLyB1cGRhdGUgbmV3IG1pbiBkaXN0YW5jZSBmb3Igbm9kZSB2CgkJCQlwcS5wdXNoKG1ha2VfcGFpcihkaXN0W3ZdLCB2KSk7IC8vIHlvdSBjYW4gdGhpbmsgb2YgZGppa3N0cmEncyBiZWluZyBhIGRpc2NyZXRlL2dyZWVkeSBCRlMuIEl0IHdpbGwgZm9jdXMgb24gdGhlIGN1cnJlbnQgc2hvcnRlc3QgcGF0aCBhbmQgZ3JlZWRpbHkgc2VhcmNoIGFkamFjZW50IHBhdGhzLgoJCQl9CgkJfQoJfQp9Cg==');
        FILE_CACHE['dsu.cpp'] = atob('dm9pZCBpbml0KCkgewogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBOOyArK2kpIHsKICAgICAgICBmYXRoZXJbaV0gPSBpOwogICAgICAgIGhlaWdodFtpXSA9IDA7CiAgICB9Cn0KCmludCBmaW5kKGludCBub2RlKSB7IC8vIGdldHMgdGhlIHJlcHJlc2VudGF0aXZlLCBvciByYXRoZXIgcmVjdXJzaXZlbHkgYXNzaWducyB0aGUgb3JpZ2luYWwgbm9kZSBhbmQgYWxsIG5vZGVzIHVwIHRoZSAidHJlZSIgdW50aWwgaXQgaXMgYXNzaWduZWQgdGhlICJyb290Ii9yZXByZXNlbnRhdGl2ZQogICAgaWYgKGZhdGhlcltub2RlXSAhPSBub2RlKSB7IC8vIG1ha2Ugc3VyZSBmYXRoZXIgaXMgZ2xvYmFsCiAgICAgICAgZmF0aGVyW25vZGVdID0gZmluZChmYXRoZXJbbm9kZV0pOwogICAgfQogICAgcmV0dXJuIGZhdGhlcltub2RlXTsKfQoKdm9pZCB1bml0ZShpbnQgQSwgaW50IEIpIHsKICAgIGludCByb290QSA9IGZpbmQoQSk7CiAgICBpbnQgcm9vdEIgPSBmaW5kKEIpOwogICAgaWYgKHJvb3RBID09IHJvb3RCKSByZXR1cm47CiAgICBpZiAoaGVpZ2h0W3Jvb3RBXSA+IGhlaWdodFtyb290Ql0pIHsKICAgICAgICBmYXRoZXJbcm9vdEJdID0gcm9vdEE7CiAgICAgICAgaGVpZ2h0W3Jvb3RBXSA9IG1heChoZWlnaHRbcm9vdEFdLCBoZWlnaHRbcm9vdEJdICsgMSk7CiAgICB9IGVsc2UgewogICAgICAgIGZhdGhlcltyb290QV0gPSByb290QjsKICAgICAgICBoZWlnaHRbcm9vdEJdID0gbWF4KGhlaWdodFtyb290Ql0sIGhlaWdodFtyb290QV0gKyAxKTsKICAgIH0KfQoKLy8gaWYgeW91IHdhbnQgdG8gaW1wbGVtZW50IEtydXNrYWwncywgaW5pdGlhbGl6ZSBhIERTVS4gCi8vIFRoZW4gYWRkIHRoZSBzb3J0ZWQgZnJvbSBsZWFzdCB0byBncmVhdGVzdCB3ZWlnaHRlZCBlZGdlcyBvbmUtYnktb25lIHRvIHRoZSBEU1UsIHdpdGggdGhlIGV4Y2VwdGlvbiBvZiB0aGUgZWRnZXMgZnJvbSB3aGljaCB0aGVpciBub2RlcyBhcmUgaW4gdGhlIHNhbWUgY29tcG9uZW50ICh3aGljaCB5b3UgY2hlY2sgdXNpbmcgdGhlIGZpbmQoKSBmdW5jdGlvbikKLy8gZm9yIHN1Y2ggZXhjZXB0aW9uLCB5b3UganVzdCBza2lwL2NvbnRpbnVlIHRoZSBsb29wLiBBbmQgdGhlbiB5b3UncmUgZG9uZSEK');
        FILE_CACHE['eulertour.cpp'] = atob('Ly8gdG9vayB0aGlzIG9uZSBkaXJlY3RseSBvZmYgb2YgVVNBQ08gR3VpZGUKLy8gVGhlIGdyYXBoIHJlcHJlc2VudGVkIGFzIGFuIGFkamFjZW5jeSBsaXN0ICgwLWluZGV4ZWQpCnZlY3Rvcjx2ZWN0b3I8aW50Pj4gbmVpZ2hib3Jze3sxLCAyfSwgezB9LCB7MCwgMywgNH0sIHsyfSwgezJ9fTsKdmVjdG9yPGludD4gc3RhcnQobmVpZ2hib3JzLnNpemUoKSk7CnZlY3RvcjxpbnQ+IGVuZChuZWlnaGJvcnMuc2l6ZSgpKTsKaW50IHRpbWVyID0gMDsKCnZvaWQgZXVsZXJfdG91cihpbnQgYXQsIGludCBwcmV2KSB7CglzdGFydFthdF0gPSB0aW1lcisrOwoJZm9yIChpbnQgbiA6IG5laWdoYm9yc1thdF0pIHsKCQlpZiAobiAhPSBwcmV2KSB7IGV1bGVyX3RvdXIobiwgYXQpOyB9Cgl9CgllbmRbYXRdID0gdGltZXI7Cn0K');
        FILE_CACHE['floydwarshall.cpp'] = atob('Ly8gVGFrZW4gYW5kIGVkaXRlZCBmcm9tIFVTQUNPIEd1aWRlLiBIb25lc3RseSBhIHZlcnkgc2ltcGxlIGltcGxlbWVudGF0aW9uLCBzbyBub3Qgc3VyZSBpZiB0aGlzIGZpbGUgaXMgcmVhbGx5IGV2ZW4gbmVlZGVkLgppbnQgbWFpbigpIHsKICB2ZWN0b3I8dmVjdG9yPGxvbmcgbG9uZz4+IG1pbl9kaXN0KG4sIHZlY3Rvcjxsb25nIGxvbmc+KG4sIElOVF9NQVgpKTsKCiAgaW50IGEsIGIsIGM7CiAgZm9yIChpbnQgaSA9IDA7IGkgPCBtOyBpKyspIHsKCQljaW4gPj4gYSA+PiBiID4+IGM7IC8vIGEgYW5kIGIgYXJlIG5vZGUgSURzLCBjIGlzIHRoZSBlZGdlIHdlaWdodCBiZXR3ZWVuIG5vZGVzIGEgYW5kIGIKCQlpZiAoYyA8IG1pbl9kaXN0W2FdW2JdKSB7IG1pbl9kaXN0W2FdW2JdID0gbWluX2Rpc3RbYl1bYV0gPSBjOyB9Cgl9CiAgCiAgZm9yIChpbnQgayA9IDA7IGsgPCBuOyBrKyspIHsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgIGZvciAoaW50IGogPSBpICsgMTsgaiA8IG47IGorKykgewogICAgICAgIGxvbmcgbG9uZyBuZXdfZGlzdCA9IG1pbl9kaXN0W2ldW2tdICsgbWluX2Rpc3Rba11bal07CiAgICAgICAgaWYgKG5ld19kaXN0IDwgbWluX2Rpc3RbaV1bal0pIHsKICAgICAgICAgIG1pbl9kaXN0W2ldW2pdID0gbWluX2Rpc3Rbal1baV0gPSBuZXdfZGlzdDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0K');
        FILE_CACHE['modinved.cpp'] = atob('Ly8gU291cmNlOiBVU0FDTyBHdWlkZSAKaW50IGludihpbnQgeCkgewoJaWYgKHggPD0gMSkgeyByZXR1cm4geDsgfQoJcmV0dXJuIE1PRCAtIE1PRCAvIHggKiBpbnYoTU9EICUgeCkgJSBNT0Q7Cn0KCi8vIFlvdSBjYW4gcHJlY29tcHV0ZSBsaWtlIHRoaXM6CmludlsxXSA9IDE7CmZvciAoaW50IGkgPSAyOyBpIDwgbTsgaSsrKSB7IGludltpXSA9IG0gLSBtIC8gaSAqIGludlttICUgaV0gJSBtOyB9Cg==');
        FILE_CACHE['rollingandfasthash.cpp'] = atob('Ly8gQm92aW5lIEdlbm9taWNzIFNvbHV0aW9uOiBodHRwczovL3VzYWNvLm9yZy9pbmRleC5waHA/cGFnZT12aWV3cHJvYmxlbTImY3BpZD03MzYKLy8gQWxzbyBjb25zaWRlciBsb29raW5nIGludG8gRmFzdCBIYXNoaW5nOiBodHRwczovL2NvZGVmb3JjZXMuY29tL2Jsb2cvZW50cnkvNjA3MzcKI2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CnVzaW5nIG5hbWVzcGFjZSBzdGQ7CgppbnQgbWFpbigpIHsKICAgIGlmc3RyZWFtIGNpbigiY293bm9taWNzLnR4dCIpOwogICAgb2ZzdHJlYW0gY291dCgiY293bm9taWNzLm91dCIpOwoKICAgIGlvc19iYXNlOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOwogICAgY2luLnRpZShOVUxMKTsKCiAgICBpbnQgbiwgbTsKICAgIGNpbiA+PiBuID4+IG07CiAgICAKICAgIHZlY3RvcjxzdHJpbmc+IHNwb3QobiksIG5vc3BvdChuKTsKICAgIHZlY3RvcjxpbnQ+IHIobSk7CiAgICBmb3IgKGludCBpID0gMDsgaSA8IG47ICsraSkgY2luID4+IHNwb3RbaV07CiAgICBmb3IgKGludCBpID0gMDsgaSA8IG47ICsraSkgY2luID4+IG5vc3BvdFtpXTsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbTsgKytpKSByW2ldID0gcmFuZCgpICUgMTAwMDAwMDA7CiAgICBpbnQgb3V0ID0gbTsKICAgIGludCBpID0gMCwgaiA9IDA7CiAgICB2ZWN0b3I8aW50PiBoMShuLCAwKSwgaDIobiwgMCk7CiAgICB1bm9yZGVyZWRfc2V0PGludD4gaDFzZXQgPSB7fTsKICAgIGJvb2wgZmxhZzsKICAgIHdoaWxlIChqIDwgbSAmJiBpIDwgbSkgewogICAgICAgIGgxc2V0ID0ge307CiAgICAgICAgZm9yIChpbnQgayA9IDA7IGsgPCBuOyArK2spIHsKICAgICAgICAgICAgaDFba10gKz0gcltqXSAqIHNwb3Rba11bal07CiAgICAgICAgICAgIGgxW2tdICU9IDEwMDAwMDAwOwogICAgICAgICAgICBoMXNldC5pbnNlcnQoaDFba10pOwogICAgICAgIH0KICAgICAgICBmbGFnID0gZmFsc2U7CiAgICAgICAgZm9yIChpbnQgayA9IDA7IGsgPCBuOyArK2spIHsKICAgICAgICAgICAgaDJba10gKz0gcltqXSAqIG5vc3BvdFtrXVtqXTsKICAgICAgICAgICAgaDJba10gJT0gMTAwMDAwMDA7CiAgICAgICAgICAgIGlmIChoMXNldC5maW5kKGgyW2tdKSAhPSBoMXNldC5lbmQoKSkgZmxhZyA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWZsYWcpIHsKICAgICAgICAgICAgb3V0ID0gbWluKG91dCwgaiAtIGkgKyAxKTsKICAgICAgICAgICAgY291dCA8PCBqIDw8ICIgIiA8PCBpIDw8IGVuZGw7CiAgICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwgbjsgKytrKSB7CiAgICAgICAgICAgICAgICBoMVtrXSAtPSByW2ldICogc3BvdFtrXVtpXTsKICAgICAgICAgICAgICAgIGgxW2tdICU9IDEwMDAwMDAwOwogICAgICAgICAgICAgICAgaDJba10gLT0gcltpXSAqIG5vc3BvdFtrXVtpXTsKICAgICAgICAgICAgICAgIGgyW2tdICU9IDEwMDAwMDAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkrKzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBqKys7CiAgICAgICAgfQogICAgICAgIGlmIChpID4gaikgewogICAgICAgICAgICBqID0gaTsKICAgICAgICB9IAogICAgfQogICAgY291dCA8PCBvdXQgPDwgZW5kbDsKfQo=');
        FILE_CACHE['segtree.cpp'] = atob('I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CnVzaW5nIG5hbWVzcGFjZSBzdGQ7Cgp1c2luZyBsbCA9IGxvbmcgbG9uZzsKCmludCBtYWluKCkgewogICAgaW9zX2Jhc2U6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7CiAgICBjaW4udGllKE5VTEwpOwoKICAgIGxsIG4sIG07CiAgICBjaW4gPj4gbiA+PiBtOwoKICAgIHZlY3RvcjxsbD4gc2VndHJlZSgyICogbiArIDIwLCAwKTsKICAgIGZvciAobGwgaSA9IDA7IGkgPCBuOyArK2kpIGNpbiA+PiBzZWd0cmVlW24gKyBpXTsKICAgIGZvciAobGwgaSA9IG4gLSAxOyBpID4gMDsgLS1pKSBzZWd0cmVlW2ldID0gc2VndHJlZVtpIDw8IDFdICsgc2VndHJlZVtpIDw8IDF8MV07CgogICAgbGwgY2hvaWNlOwogICAgbGwgZiwgczsKICAgIGxsIHJlczsKICAgIGZvciAobGwgaSA9IDA7IGkgPCBtOyArK2kpIHsKICAgICAgICBjaW4gPj4gY2hvaWNlOwogICAgICAgIGlmIChjaG9pY2UgPT0gMSkgewogICAgICAgICAgICBjaW4gPj4gZiA+PiBzOwogICAgICAgICAgICBmLS07CiAgICAgICAgICAgIHNlZ3RyZWVbbiArIGZdID0gczsKICAgICAgICAgICAgZm9yIChsbCBqID0gbiArIGY7IGogPiAxOyBqID4+PSAxKQogICAgICAgICAgICAgICAgc2VndHJlZVtqID4+IDFdID0gc2VndHJlZVtqXSArIHNlZ3RyZWVbal4gMV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY2luID4+IGYgPj4gczsgZi0tOwogICAgICAgICAgICByZXMgPSAwOwogICAgICAgICAgICBmb3IgKGYgKz0gbiwgcys9IG47IGYgPCBzOyBmID4+PSAxLCBzID4+PSAxKSB7CiAgICAgICAgICAgICAgICBpZiAoZiAmIDEpIHJlcyArPSBzZWd0cmVlW2YrK107CiAgICAgICAgICAgICAgICBpZiAocSAmIDEpIHJlcyArPSBzZWd0cmVlWy0tcy07OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvdXQgPDwgcmVzIDw8IGVuZGw7CiAgICAgICAgfQogICAgfQp9Cg==');
        FILE_CACHE['toposort.cpp'] = atob('Ly8gdG9vayB0aGlzIG9uZSBkaXJlY3RseSBvZmYgb2YgVVNBQ08gR3VpZGUKCmludCBtYWluKCkgewoJaW50IG4sIG07CgljaW4gPj4gbiA+PiBtOwoJdmVjdG9yPHZlY3RvcjxpbnQ+PiBncmFwaChuKTsKCXZlY3RvcjxpbnQ+IGluZGVncmVlKG4sIDApOwoJcXVldWU8aW50PiBxOwoJZm9yIChpbnQgaSA9IDA7IGkgPCBtOyBpKyspIHsKCQlpbnQgYSwgYjsKCQljaW4gPj4gYSA+PiBiOwoJCWdyYXBoW2EgLSAxXS5wdXNoX2JhY2soYiAtIDEpOwoJCWluZGVncmVlW2IgLSAxXSsrOwoJfQoJZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpKyspIHsKCQkvLyBsb2NhdGUgdGhlIG5vZGVzIHdpdGggaW5kZWdyZWUgMCBhbmQgcHVzaCB0aGVtIGludG8gdGhlIHF1ZXVlCgkJaWYgKGluZGVncmVlW2ldID09IDApIHsgcS5wdXNoKGkpOyB9Cgl9Cgl2ZWN0b3I8aW50PiBvcmRlcjsKCXdoaWxlICghcS5lbXB0eSgpKSB7CgkJaW50IGN1cnIgPSBxLmZyb250KCk7CgkJcS5wb3AoKTsKCQkvLyBhZGQgdGhlIGN1cnJlbnQgbm9kZSB0byB0aGUgb3JkZXIKCQlvcmRlci5wdXNoX2JhY2soY3Vycik7CgkJZm9yIChpbnQgbmV4dCA6IGdyYXBoW2N1cnJdKSB7CgkJCS8vIHJlbW92ZSB0aGUgY3VycmVudCBub2RlIGZyb20gdGhlIGdyYXBoCgkJCWluZGVncmVlW25leHRdLS07CgkJCS8vIHB1c2ggYW55IG5ldyBub2RlcyB3aXRoIGluZGVncmVlIDAgaW50byB0aGUgcXVldWUKCQkJaWYgKGluZGVncmVlW25leHRdID09IDApIHsgcS5wdXNoKG5leHQpOyB9CgkJfQoJfQoJLy8gaWYgdGhlcmUgaXNuJ3QgYSB2YWxpZCB0b3BvbG9naWNhbCBzb3J0aW5nCglpZiAob3JkZXIuc2l6ZSgpICE9IG4pIHsKCQljb3V0IDw8ICJJTVBPU1NJQkxFIiA8PCBlbmRsOwoJCXJldHVybiAwOwoJfQoJY291dCA8PCBvcmRlclswXSArIDE7Cglmb3IgKGludCBpID0gMTsgaSA8IG47IGkrKykgeyBjb3V0IDw8ICIgIiA8PCBvcmRlcltpXSArIDE7IH0KCWNvdXQgPDwgZW5kbDsKCXJldHVybiAwOwp9Cg==');
        // Build the list into the DOM after populating FILE_CACHE
        buildUsacoList(algoFiles);
        loadBlog();
        loadVideos();
        loadMisc();
      }
      initSite();
      // Initialize the ASCII D viewer once the DOM is ready.  This function
      // draws a 3D D using ASCII characters and allows the user to drag
      // to change the viewing angles.  When not dragging the D rotates
      // slowly by itself.  See initDViewer() implementation below.
      initDViewer();
    </script>
  </body>
</html>